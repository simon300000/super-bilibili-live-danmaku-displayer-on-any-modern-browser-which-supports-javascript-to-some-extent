<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>super bilibili live danmaku displayer on any modern browser which supports javascript to some extent</title>
</head>

<body></body>

<script type="text/javascript">
	console.log('super bilibili live danmaku displayer on any modern browser which supports javascript to some extent is now started')
	const roomid = Number(new URL(location.href).searchParams.get('roomid'))
	console.log(`roomid: ${roomid}`)

	const aWebSocket = new WebSocket('wss://broadcastlv.chat.bilibili.com/sub')
	aWebSocket.binaryType = 'arraybuffer'

	aWebSocket.onclose = () => {
		console.log('WebSocket close')
		console.log('restart')
		eval(document.getElementsByTagName('script')[0].innerHTML)
	}

	aWebSocket.onopen = () => {
		console.log('WebSocket open')
	}

	aWebSocket.onmessage = e => {
		console.debug('WebSocket message received:', e)
	}

</script>

</html>
